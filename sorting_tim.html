<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TimSort | AlgoViz Hub</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;500;700&family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary: #0f172a;
        --secondary: #1e293b;
        --accent: #6366f1;
        --accent-light: #818cf8;
        --accent-glow: rgba(99, 102, 241, 0.2);
        --text: #e2e8f0;
        --text-secondary: #94a3b8;
        --card-bg: rgba(30, 41, 59, 0.7);
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --transition: all 0.3s ease;
        --radius: 12px;
        --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        --glow: 0 0 15px var(--accent-glow);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: var(--text);
        font-family: "Roboto", sans-serif;
        line-height: 1.6;
        min-height: 100vh;
        padding: 0;
        position: relative;
        overflow-x: hidden;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 10% 20%,
            rgba(99, 102, 241, 0.1) 0%,
            transparent 20%
          ),
          radial-gradient(
            circle at 90% 80%,
            rgba(129, 140, 248, 0.1) 0%,
            transparent 20%
          );
        z-index: -1;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Header Styles */
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0;
        position: relative;
        border-bottom: 1px solid rgba(148, 163, 184, 0.2);
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .logo-icon {
        width: 50px;
        height: 50px;
        background: var(--accent);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--glow);
      }

      .logo-icon i {
        font-size: 24px;
        color: white;
      }

      .logo-text h1 {
        font-family: "Roboto Mono", monospace;
        font-weight: 700;
        font-size: 28px;
        background: linear-gradient(
          to right,
          var(--accent-light),
          var(--accent)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .logo-text p {
        font-size: 14px;
        color: var(--text-secondary);
        letter-spacing: 1.5px;
      }

      .breadcrumb {
        font-size: 14px;
        color: var(--text-secondary);
        margin-top: 10px;
      }

      .breadcrumb a {
        color: var(--accent-light);
        text-decoration: none;
        transition: var(--transition);
      }

      .breadcrumb a:hover {
        text-decoration: underline;
      }

      /* Algorithm Header */
      .algorithm-header {
        margin: 40px 0;
        text-align: center;
        padding: 20px;
        background: var(--card-bg);
        border-radius: var(--radius);
        border: 1px solid rgba(148, 163, 184, 0.1);
        backdrop-filter: blur(10px);
        position: relative;
        overflow: hidden;
      }

      .algorithm-header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(
          to right,
          var(--accent),
          var(--accent-light)
        );
      }

      .algorithm-header h1 {
        font-size: 42px;
        margin-bottom: 15px;
        background: linear-gradient(
          to right,
          var(--accent-light),
          var(--accent)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 800;
      }

      .algorithm-header .category {
        font-size: 18px;
        color: var(--accent-light);
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      .complexity-badge {
        display: inline-block;
        background: rgba(129, 140, 248, 0.2);
        color: var(--accent-light);
        padding: 6px 15px;
        border-radius: 20px;
        font-size: 16px;
        font-weight: 600;
        font-family: "Roboto Mono", monospace;
        margin-top: 15px;
      }

      /* Main Content Layout */
      .main-content {
        display: grid;
        grid-template-columns: 1fr 350px;
        gap: 30px;
        margin-bottom: 40px;
      }

      @media (max-width: 900px) {
        .main-content {
          grid-template-columns: 1fr;
        }
      }

      /* Algorithm Detail Sections */
      .section {
        background: var(--card-bg);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 30px;
        margin-bottom: 30px;
        border: 1px solid rgba(148, 163, 184, 0.1);
        backdrop-filter: blur(10px);
        position: relative;
        overflow: hidden;
      }

      .section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(
          to right,
          var(--accent),
          var(--accent-light)
        );
      }

      .section h2 {
        font-size: 26px;
        margin-bottom: 20px;
        color: var(--accent-light);
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .section h2 i {
        color: var(--accent);
        width: 36px;
        height: 36px;
        background: rgba(99, 102, 241, 0.2);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .section p {
        color: var(--text-secondary);
        font-size: 17px;
        line-height: 1.8;
        margin-bottom: 20px;
      }

      .key-points {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin: 25px 0;
      }

      .point-card {
        background: rgba(15, 23, 42, 0.5);
        border-radius: var(--radius);
        padding: 20px;
        border: 1px solid rgba(148, 163, 184, 0.1);
      }

      .point-card h3 {
        color: var(--accent-light);
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .point-card h3 i {
        color: var(--accent);
      }

      .point-card p {
        margin-bottom: 0;
        font-size: 15px;
      }

      /* Visualization Console */
      .visualization-console {
        background: rgba(15, 23, 42, 0.8);
        border-radius: var(--radius);
        padding: 25px;
        margin: 30px 0;
        border: 1px solid rgba(99, 102, 241, 0.3);
        box-shadow: var(--glow);
      }

      .console-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .console-header h3 {
        color: var(--accent-light);
        font-size: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .console-controls {
        display: flex;
        gap: 10px;
      }

      .console-btn {
        background: var(--accent);
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-family: "Roboto Mono", monospace;
        transition: var(--transition);
      }

      .console-btn:hover {
        background: var(--accent-light);
      }

      .console-btn.secondary {
        background: rgba(148, 163, 184, 0.2);
      }

      .visualization-area {
        height: 350px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }

      .visualization-area::before {
        content: "TimSort Visualization";
        position: absolute;
        color: rgba(148, 163, 184, 0.5);
        font-size: 20px;
      }

      .console-input {
        display: flex;
        gap: 10px;
        margin-top: 20px;
      }

      .console-input input {
        flex: 1;
        padding: 12px 15px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(148, 163, 184, 0.2);
        border-radius: 5px;
        color: var(--text);
        font-family: "Roboto Mono", monospace;
      }

      .console-input input:focus {
        outline: none;
        border-color: var(--accent);
      }

      /* Algorithm Properties */
      .properties-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .property-card {
        background: rgba(15, 23, 42, 0.5);
        border-radius: var(--radius);
        padding: 20px;
        border: 1px solid rgba(148, 163, 184, 0.1);
        text-align: center;
      }

      .property-card h4 {
        color: var(--text-secondary);
        font-size: 14px;
        margin-bottom: 8px;
        font-weight: 400;
      }

      .property-card .value {
        font-size: 20px;
        font-weight: 700;
        color: var(--accent-light);
        font-family: "Roboto Mono", monospace;
      }

      /* Footer */
      footer {
        text-align: center;
        padding: 40px 0 30px;
        color: var(--text-secondary);
        font-size: 14px;
        border-top: 1px solid rgba(148, 163, 184, 0.1);
        margin-top: 40px;
      }

      footer p {
        margin: 10px 0;
      }

      .footer-links {
        display: flex;
        justify-content: center;
        gap: 25px;
        margin-top: 15px;
        flex-wrap: wrap;
        margin-bottom: 20px;
      }

      .footer-links a {
        color: var(--accent-light);
        text-decoration: none;
        transition: var(--transition);
      }

      .footer-links a:hover {
        color: var(--accent);
      }

      /* Animations */
      @keyframes float {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
        100% {
          transform: translateY(0px);
        }
      }

      .floating {
        animation: float 6s ease-in-out infinite;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        header {
          flex-direction: column;
          gap: 25px;
          text-align: center;
        }

        .algorithm-header h1 {
          font-size: 32px;
        }

        .key-points {
          grid-template-columns: 1fr;
        }
      }

      /* Code Block Styling */
      .code-block {
        background: #0d1117;
        border-radius: 8px;
        padding: 20px;
        margin: 25px 0;
        overflow-x: auto;
        font-family: "Roboto Mono", monospace;
        font-size: 15px;
        border: 1px solid rgba(99, 102, 241, 0.3);
      }

      .code-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        color: var(--text-secondary);
      }

      .copy-btn {
        background: rgba(99, 102, 241, 0.2);
        color: var(--accent-light);
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        font-family: "Roboto Mono", monospace;
        transition: var(--transition);
      }

      .copy-btn:hover {
        background: rgba(99, 102, 241, 0.3);
      }

      .code-block pre {
        margin: 0;
      }

      .code-block code {
        color: #c9d1d9;
        line-height: 1.5;
      }

      .keyword {
        color: #ff7b72;
      }
      .function {
        color: #d2a8ff;
      }
      .comment {
        color: #8b949e;
      }
      .string {
        color: #a5d6ff;
      }
      .number {
        color: #79c0ff;
      }

      /* TimSort Visualization Styles */
      .array-container {
        display: flex;
        justify-content: center;
        align-items: flex-end;
        height: 100%;
        width: 100%;
        padding: 20px;
        gap: 5px;
      }

      .array-element {
        width: 30px;
        background: var(--accent);
        border-radius: 8px 8px 0 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-end;
        position: relative;
        transition: all 0.3s ease;
      }

      .element-value {
        font-size: 16px;
        font-weight: bold;
        margin-top: 5px;
        margin-bottom: 5px;
        font-family: "Roboto Mono", monospace;
      }

      .run {
        position: relative;
      }

      .run::after {
        content: "";
        position: absolute;
        bottom: -15px;
        left: 0;
        right: 0;
        height: 2px;
        background: var(--warning);
      }

      .run-label {
        position: absolute;
        bottom: -30px;
        left: 50%;
        transform: translateX(-50%);
        color: var(--warning);
        font-size: 12px;
        font-family: "Roboto Mono", monospace;
        white-space: nowrap;
      }

      .active {
        box-shadow: 0 0 0 3px var(--success);
      }

      .minimized {
        opacity: 0.5;
      }

      .insertion-active {
        background: var(--warning);
      }

      .merge-active {
        background: var(--success);
      }

      .stats-bar {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0, 0, 0, 0.5);
        padding: 8px 12px;
        border-radius: 5px;
        font-size: 14px;
        display: flex;
        gap: 15px;
      }

      .stats-item {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .controls {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        justify-content: center;
      }

      .speed-control {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .step-info {
        position: absolute;
        bottom: 10px;
        left: 0;
        right: 0;
        text-align: center;
        color: var(--accent-light);
        font-family: "Roboto Mono", monospace;
        min-height: 20px;
        padding: 5px;
        background: rgba(0, 0, 0, 0.5);
      }

      .run-info {
        position: absolute;
        top: 10px;
        right: 10px;
        color: var(--warning);
        font-family: "Roboto Mono", monospace;
        font-weight: bold;
        background: rgba(0, 0, 0, 0.5);
        padding: 5px 10px;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header>
        <div class="logo">
          <div class="logo-icon floating">
            <i class="fas fa-project-diagram"></i>
          </div>
          <div class="logo-text">
            <h1>AlgoViz Hub</h1>
            <p>ALGORITHM VISUALIZATION REPOSITORY</p>
            <div class="breadcrumb">
              <a href="#"><i class="fas fa-home"></i> Home</a> >
              <a href="#">Sorting Algorithms</a> >
              <span>TimSort</span>
            </div>
          </div>
        </div>
      </header>

      <!-- Algorithm Header -->
      <div class="algorithm-header">
        <h1>TimSort</h1>
        <div class="category">
          <i class="fas fa-sort-amount-down"></i> Hybrid Sorting Algorithm
        </div>
        <div class="complexity-badge">Time Complexity: O(n log n)</div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Left Column: Algorithm Details -->
        <div class="left-column">
          <!-- Description Section -->
          <div class="section">
            <h2><i class="fas fa-file-alt"></i> Algorithm Overview</h2>
            <p>
              TimSort is a hybrid stable sorting algorithm derived from Merge
              Sort and Insertion Sort. Designed to perform well on real-world
              data, it is the default sorting algorithm in Python, Java, and
              Android.
            </p>
            <p>
              TimSort works by identifying "runs" (either strictly
              non-decreasing or strictly decreasing sequences), sorting small
              runs with Insertion Sort, and then merging runs efficiently using
              a method similar to Merge Sort. It's optimized to take advantage
              of partially ordered data.
            </p>

            <div class="key-points">
              <div class="point-card">
                <h3><i class="fas fa-check-circle"></i> Key Feature</h3>
                <p>Optimized for real-world data with existing ordering</p>
              </div>
              <div class="point-card">
                <h3><i class="fas fa-bolt"></i> Performance</h3>
                <p>O(n) best case (already sorted), O(n log n) worst case</p>
              </div>
              <div class="point-card">
                <h3><i class="fas fa-memory"></i> Space</h3>
                <p>O(n) worst-case space complexity</p>
              </div>
              <div class="point-card">
                <h3><i class="fas fa-project-diagram"></i> Approach</h3>
                <p>Hybrid of Insertion Sort and optimized Merge Sort</p>
              </div>
            </div>
          </div>

          <!-- Visualization Console -->
          <div class="section">
            <h2>
              <i class="fas fa-laptop-code"></i> Interactive Visualization
            </h2>
            <p>
              Visualize TimSort in action! The visualization shows how TimSort
              identifies runs, sorts them with Insertion Sort, and then merges
              them efficiently. Enter numbers or generate a random array to see
              the algorithm work.
            </p>

            <div class="visualization-console">
              <div class="console-header">
                <h3>
                  <i class="fas fa-play-circle"></i> TimSort Visualization
                </h3>
                <div class="console-controls">
                  <button class="console-btn" id="reset-btn">
                    <i class="fas fa-redo"></i> Reset
                  </button>
                  <button class="console-btn" id="run-btn">
                    <i class="fas fa-play"></i> Run
                  </button>
                </div>
              </div>

              <div class="visualization-area" id="viz-area">
                <div class="array-container" id="array-container"></div>

                <div class="stats-bar" id="stats-bar">
                  <div class="stats-item">
                    <i
                      class="fas fa-layer-group"
                      style="color: var(--accent-light)"
                    ></i>
                    <span>Runs: <span id="run-count">0</span></span>
                  </div>
                  <div class="stats-item">
                    <i
                      class="fas fa-exchange-alt"
                      style="color: var(--success)"
                    ></i>
                    <span>Merges: <span id="merge-count">0</span></span>
                  </div>
                </div>

                <div class="run-info">Min Run: <span id="min-run">4</span></div>

                <div class="step-info" id="step-info">
                  Ready to visualize TimSort!
                </div>
              </div>

              <div class="console-input">
                <input
                  type="text"
                  id="array-input"
                  value="5, 2, 8, 3, 9, 1, 6, 4, 7, 10, 15, 12, 18, 11, 14, 13, 17, 16, 19, 20"
                  placeholder="Enter numbers (e.g., 5, 2, 8, 3, 9, 1, 6, 4, 7)"
                />
                <button class="console-btn" id="random-btn">
                  <i class="fas fa-random"></i> Random
                </button>
              </div>

              <div class="controls">
                <div class="speed-control">
                  <i
                    class="fas fa-tachometer-alt"
                    style="color: var(--accent-light)"
                  ></i>
                  <input
                    type="range"
                    id="speed-slider"
                    min="1"
                    max="10"
                    value="5"
                  />
                  <span id="speed-value">Medium</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Algorithm Steps -->
          <div class="section">
            <h2><i class="fas fa-list-ol"></i> Algorithm Steps</h2>
            <p>
              TimSort combines the efficiency of Insertion Sort for small runs
              with the power of Merge Sort for larger sequences:
            </p>

            <div class="key-points">
              <div class="point-card">
                <h3><i class="fas fa-search"></i> 1. Identify Runs</h3>
                <p>
                  Traverse the array to find natural runs (ascending or strictly
                  descending sequences).
                </p>
              </div>
              <div class="point-card">
                <h3><i class="fas fa-expand"></i> 2. Extend Runs</h3>
                <p>
                  Extend short runs to minrun length using Insertion Sort
                  (default minrun is 32-64).
                </p>
              </div>
              <div class="point-card">
                <h3><i class="fas fa-sort"></i> 3. Sort Small Runs</h3>
                <p>
                  Use Insertion Sort to sort runs that are shorter than minrun.
                </p>
              </div>
              <div class="point-card">
                <h3><i class="fas fa-code-branch"></i> 4. Merge Runs</h3>
                <p>
                  Merge runs using a stack-based approach, favoring runs of
                  similar size.
                </p>
              </div>
              <div class="point-card">
                <h3><i class="fas fa-sync-alt"></i> 5. Galloping Mode</h3>
                <p>
                  Use "galloping" optimization during merges for long stretches
                  of elements.
                </p>
              </div>
            </div>
          </div>

          <!-- Pseudocode Section -->
          <div class="section">
            <h2><i class="fas fa-list-ol"></i> Pseudocode</h2>
            <div class="code-block">
              <pre><code>function timSort(arr):
    minrun = calculateMinRun(len(arr))
    
    // Sort individual runs of size minrun
    for start from 0 to len(arr) by minrun:
        end = min(start + minrun - 1, len(arr) - 1)
        insertionSort(arr, start, end)
    
    // Merge runs
    size = minrun
    while size < len(arr):
        for left from 0 to len(arr) by 2*size:
            mid = min(len(arr)-1, left + size - 1)
            right = min(len(arr)-1, left + 2*size - 1)
            merge(arr, left, mid, right)
        size = 2 * size

function insertionSort(arr, left, right):
    for i from left+1 to right:
        j = i
        while j > left and arr[j] < arr[j-1]:
            swap arr[j] and arr[j-1]
            j -= 1

function merge(arr, l, m, r):
    len1 = m - l + 1
    len2 = r - m
    left = arr[l..m]
    right = arr[m+1..r]
    
    i = 0, j = 0, k = l
    while i < len1 and j < len2:
        if left[i] <= right[j]:
            arr[k] = left[i]
            i += 1
        else:
            arr[k] = right[j]
            j += 1
        k += 1
    
    // Copy remaining elements
    while i < len1:
        arr[k] = left[i]
        i += 1
        k += 1
    while j < len2:
        arr[k] = right[j]
        j += 1
        k += 1</code></pre>
            </div>
          </div>

          <!-- Implementation Section -->
          <div class="section">
            <h2><i class="fas fa-code"></i> Implementation</h2>
            <p>
              Below is a simplified Python implementation of TimSort. Note that
              the actual implementation includes optimizations like galloping
              mode and run-length adjustment.
            </p>

            <div class="code-block">
              <div class="code-header">
                <span>Python Implementation</span>
                <button class="copy-btn">
                  <i class="fas fa-copy"></i> Copy Code
                </button>
              </div>
              <pre><code><span class="keyword">def</span> <span class="function">tim_sort</span>(arr):
    minrun = 32
    n = len(arr)
    
    <span class="comment"># Sort individual runs</span>
    <span class="keyword">for</span> start <span class="keyword">in</span> range(0, n, minrun):
        end = min(start + minrun - 1, n - 1)
        insertion_sort(arr, start, end)
    
    <span class="comment"># Merge runs</span>
    size = minrun
    <span class="keyword">while</span> size < n:
        <span class="keyword">for</span> left <span class="keyword">in</span> range(0, n, 2 * size):
            mid = min(n - 1, left + size - 1)
            right = min(n - 1, left + 2 * size - 1)
            <span class="keyword">if</span> mid < right:
                merge(arr, left, mid, right)
        size = 2 * size

<span class="keyword">def</span> <span class="function">insertion_sort</span>(arr, left, right):
    <span class="keyword">for</span> i <span class="keyword">in</span> range(left + 1, right + 1):
        j = i
        <span class="keyword">while</span> j > left <span class="keyword">and</span> arr[j] < arr[j - 1]:
            arr[j], arr[j - 1] = arr[j - 1], arr[j]
            j -= 1

<span class="keyword">def</span> <span class="function">merge</span>(arr, l, m, r):
    len1 = m - l + 1
    len2 = r - m
    left = arr[l:m + 1]
    right = arr[m + 1:r + 1]
    
    i = j = 0
    k = l
    
    <span class="keyword">while</span> i < len1 <span class="keyword">and</span> j < len2:
        <span class="keyword">if</span> left[i] <= right[j]:
            arr[k] = left[i]
            i += 1
        <span class="keyword">else</span>:
            arr[k] = right[j]
            j += 1
        k += 1
    
    <span class="keyword">while</span> i < len1:
        arr[k] = left[i]
        i += 1
        k += 1
    
    <span class="keyword">while</span> j < len2:
        arr[k] = right[j]
        j += 1
        k += 1

<span class="comment"># Example usage</span>
arr = [5, 2, 8, 3, 9, 1, 6, 4, 7]
tim_sort(arr)
print(<span class="string">"Sorted array:"</span>, arr)  <span class="comment"># Output: [1, 2, 3, 4, 5, 6, 7, 8, 9]</span></code></pre>
            </div>
          </div>
        </div>

        <!-- Right Column: Additional Info -->
        <div class="right-column">
          <!-- Properties Section -->
          <div class="section">
            <h2><i class="fas fa-info-circle"></i> Algorithm Properties</h2>
            <div class="properties-grid">
              <div class="property-card">
                <h4>Category</h4>
                <div class="value">Sorting</div>
              </div>
              <div class="property-card">
                <h4>Type</h4>
                <div class="value">Hybrid</div>
              </div>
              <div class="property-card">
                <h4>Stable</h4>
                <div class="value">Yes</div>
              </div>
              <div class="property-card">
                <h4>In-place</h4>
                <div class="value">No</div>
              </div>
              <div class="property-card">
                <h4>Best Case</h4>
                <div class="value">O(n)</div>
              </div>
              <div class="property-card">
                <h4>Worst Case</h4>
                <div class="value">O(n log n)</div>
              </div>
              <div class="property-card">
                <h4>Average Case</h4>
                <div class="value">O(n log n)</div>
              </div>
              <div class="property-card">
                <h4>Space</h4>
                <div class="value">O(n)</div>
              </div>
            </div>
          </div>

          <!-- Applications Section -->
          <div class="section">
            <h2><i class="fas fa-lightbulb"></i> Applications</h2>
            <p>TimSort is widely used in programming languages and systems:</p>
            <ul
              style="
                padding-left: 20px;
                margin: 15px 0;
                color: var(--text-secondary);
              "
            >
              <li style="margin-bottom: 10px">
                Default sorting algorithm in Python (since 2.3)
              </li>
              <li style="margin-bottom: 10px">
                Used in Java for non-primitive arrays (Arrays.sort())
              </li>
              <li style="margin-bottom: 10px">
                Android platform for Java API sorting
              </li>
              <li style="margin-bottom: 10px">
                V8 JavaScript engine (used in Chrome and Node.js)
              </li>
              <li>Sorting large datasets with partial ordering</li>
            </ul>
          </div>

          <!-- Advantages/Disadvantages Section -->
          <div class="section">
            <h2>
              <i class="fas fa-balance-scale"></i> Advantages & Disadvantages
            </h2>
            <div style="margin-top: 20px">
              <h3 style="color: var(--success); margin-bottom: 10px">
                <i class="fas fa-check-circle"></i> Advantages
              </h3>
              <ul
                style="
                  padding-left: 20px;
                  margin-bottom: 20px;
                  color: var(--text-secondary);
                "
              >
                <li style="margin-bottom: 8px">
                  Highly efficient for real-world data
                </li>
                <li style="margin-bottom: 8px">Stable sorting algorithm</li>
                <li style="margin-bottom: 8px">
                  Optimized for partially ordered data
                </li>
                <li>Linear time complexity for already sorted data</li>
              </ul>

              <h3 style="color: var(--danger); margin-bottom: 10px">
                <i class="fas fa-exclamation-circle"></i> Disadvantages
              </h3>
              <ul style="padding-left: 20px; color: var(--text-secondary)">
                <li style="margin-bottom: 8px">
                  More complex to implement than basic algorithms
                </li>
                <li style="margin-bottom: 8px">
                  Requires O(n) additional space
                </li>
                <li style="margin-bottom: 8px">
                  Not a strictly in-place algorithm
                </li>
                <li>Constant factors are higher than simpler algorithms</li>
              </ul>
            </div>
          </div>

          <!-- Complexity Analysis -->
          <div class="section">
            <h2><i class="fas fa-chart-bar"></i> Complexity Analysis</h2>
            <p style="margin-bottom: 15px">
              TimSort's performance adapts to the input data characteristics:
            </p>
            <div
              style="
                background: rgba(15, 23, 42, 0.5);
                border-radius: var(--radius);
                padding: 15px;
              "
            >
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span>Best Case:</span>
                <span
                  style="
                    font-family: 'Roboto Mono', monospace;
                    color: var(--accent-light);
                  "
                  >O(n)</span
                >
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span>Average Case:</span>
                <span
                  style="
                    font-family: 'Roboto Mono', monospace;
                    color: var(--accent-light);
                  "
                  >O(n log n)</span
                >
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span>Worst Case:</span>
                <span
                  style="
                    font-family: 'Roboto Mono', monospace;
                    color: var(--accent-light);
                  "
                  >O(n log n)</span
                >
              </div>
              <div style="margin-top: 15px">
                <p style="color: var(--text-secondary); font-size: 15px">
                  The algorithm performs exceptionally well on partially sorted
                  data, with performance approaching O(n) when the data has
                  significant existing order.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer>
        <div class="footer-links">
          <a href="#"><i class="fas fa-book"></i> Documentation</a>
          <a href="#"><i class="fas fa-code-branch"></i> Contribute</a>
          <a href="#"><i class="fas fa-chalkboard-teacher"></i> Tutorials</a>
          <a href="#"><i class="fas fa-bug"></i> Report Issue</a>
          <a href="#"><i class="fas fa-envelope"></i> Contact</a>
        </div>
        <p>AlgoViz Hub - Interactive Algorithm Visualization Platform</p>
        <p>&copy; 2025 AlgoViz Hub. All rights reserved.</p>
      </footer>
    </div>

    <script>
      // DOM elements
      const runBtn = document.getElementById("run-btn");
      const resetBtn = document.getElementById("reset-btn");
      const randomBtn = document.getElementById("random-btn");
      const arrayInput = document.getElementById("array-input");
      const arrayContainer = document.getElementById("array-container");
      const vizArea = document.getElementById("viz-area");
      const speedSlider = document.getElementById("speed-slider");
      const speedValue = document.getElementById("speed-value");
      const runCount = document.getElementById("run-count");
      const mergeCount = document.getElementById("merge-count");
      const minRun = document.getElementById("min-run");
      const stepInfo = document.getElementById("step-info");
      const copyBtn = document.querySelector(".copy-btn");

      // Algorithm state
      let arr = [];
      let originalArr = [];
      let animationQueue = [];
      let isRunning = false;
      let speed = 500;
      let minrun = 4;
      let runs = 0;
      let merges = 0;

      // Initialize visualization
      function initVisualization() {
        const input = arrayInput.value.trim();
        arr = input
          ? input.split(",").map((num) => parseInt(num.trim()))
          : [
              5, 2, 8, 3, 9, 1, 6, 4, 7, 10, 15, 12, 18, 11, 14, 13, 17, 16, 19,
              20,
            ];
        originalArr = [...arr];

        // Reset state
        animationQueue = [];
        runs = 0;
        merges = 0;
        minrun = Math.min(8, Math.max(4, Math.floor(arr.length / 8)));

        updateStats();
        stepInfo.textContent = "Ready to visualize TimSort!";

        // Clear container
        arrayContainer.innerHTML = "";

        // Create array elements
        arr.forEach((value, index) => {
          const element = document.createElement("div");
          element.className = "array-element";
          element.style.height = `${value * 15}px`;
          element.innerHTML = `
          <div class="element-value">${value}</div>
        `;
          element.dataset.index = index;
          element.dataset.value = value;
          arrayContainer.appendChild(element);
        });

        minRun.textContent = minrun;
      }

      // Update statistics display
      function updateStats() {
        runCount.textContent = runs;
        mergeCount.textContent = merges;
      }

      // Highlight run
      function highlightRun(start, end) {
        const elements = arrayContainer.querySelectorAll(".array-element");
        for (let i = start; i <= end; i++) {
          if (i < elements.length) {
            elements[i].classList.add("run");
            if (i === start) {
              const label = document.createElement("div");
              label.className = "run-label";
              label.textContent = `Run ${runs}`;
              elements[i].appendChild(label);
            }
          }
        }
      }

      // TimSort algorithm with visualization steps
      function timSortWithVisualization() {
        animationQueue = [];
        runs = 0;
        merges = 0;

        // Step 1: Sort runs with insertion sort
        stepInfo.textContent = "Sorting runs with Insertion Sort...";
        for (let start = 0; start < arr.length; start += minrun) {
          const end = Math.min(start + minrun - 1, arr.length - 1);

          // Highlight run
          animationQueue.push(() => {
            highlightRun(start, end);
            runs++;
            updateStats();
            stepInfo.textContent = `Sorting run ${runs} (indices ${start}-${end})`;
          });

          // Insertion sort visualization for this run
          for (let i = start + 1; i <= end; i++) {
            let j = i;

            // Highlight current element
            animationQueue.push(() => {
              const elements =
                arrayContainer.querySelectorAll(".array-element");
              if (j < elements.length) {
                elements[j].classList.add("insertion-active");
              }
            });

            while (j > start && arr[j] < arr[j - 1]) {
              // Swap elements
              animationQueue.push(() => {
                [arr[j], arr[j - 1]] = [arr[j - 1], arr[j]];

                const elements =
                  arrayContainer.querySelectorAll(".array-element");
                if (j < elements.length) {
                  const tempHeight = elements[j].style.height;
                  const tempValue =
                    elements[j].querySelector(".element-value").textContent;

                  elements[j].style.height = elements[j - 1].style.height;
                  elements[j].querySelector(".element-value").textContent =
                    elements[j - 1].querySelector(".element-value").textContent;

                  elements[j - 1].style.height = tempHeight;
                  elements[j - 1].querySelector(".element-value").textContent =
                    tempValue;
                }
              });

              j--;

              // Update highlight
              animationQueue.push(() => {
                const elements =
                  arrayContainer.querySelectorAll(".array-element");
                elements.forEach((el) =>
                  el.classList.remove("insertion-active")
                );
                if (j < elements.length) {
                  elements[j].classList.add("insertion-active");
                }
              });
            }

            // Remove highlight
            animationQueue.push(() => {
              const elements =
                arrayContainer.querySelectorAll(".array-element");
              elements.forEach((el) => el.classList.remove("insertion-active"));
            });
          }
        }

        // Step 2: Merge runs
        stepInfo.textContent = "Merging sorted runs...";
        let size = minrun;
        while (size < arr.length) {
          for (let left = 0; left < arr.length; left += 2 * size) {
            const mid = Math.min(left + size - 1, arr.length - 1);
            const right = Math.min(left + 2 * size - 1, arr.length - 1);

            if (mid < right) {
              // Highlight merge area
              animationQueue.push(() => {
                stepInfo.textContent = `Merging runs (${left}-${mid} and ${
                  mid + 1
                }-${right})`;
                merges++;
                updateStats();

                const elements =
                  arrayContainer.querySelectorAll(".array-element");
                for (let i = left; i <= right; i++) {
                  if (i < elements.length) {
                    elements[i].classList.add("merge-active");
                  }
                }
              });

              // Simulate merge (simplified for visualization)
              const temp = [...arr];
              let i = left;
              let j = mid + 1;
              let k = left;

              while (i <= mid && j <= right) {
                if (temp[i] <= temp[j]) {
                  arr[k] = temp[i];
                  i++;
                } else {
                  arr[k] = temp[j];
                  j++;
                }
                k++;

                // Update visualization for this step
                animationQueue.push(() => {
                  const elements =
                    arrayContainer.querySelectorAll(".array-element");
                  if (k - 1 < elements.length) {
                    elements[k - 1].style.height = `${arr[k - 1] * 15}px`;
                    elements[k - 1].querySelector(
                      ".element-value"
                    ).textContent = arr[k - 1];
                  }
                });
              }

              while (i <= mid) {
                arr[k] = temp[i];
                k++;
                i++;
                animationQueue.push(() => {
                  const elements =
                    arrayContainer.querySelectorAll(".array-element");
                  if (k - 1 < elements.length) {
                    elements[k - 1].style.height = `${arr[k - 1] * 15}px`;
                    elements[k - 1].querySelector(
                      ".element-value"
                    ).textContent = arr[k - 1];
                  }
                });
              }

              while (j <= right) {
                arr[k] = temp[j];
                k++;
                j++;
                animationQueue.push(() => {
                  const elements =
                    arrayContainer.querySelectorAll(".array-element");
                  if (k - 1 < elements.length) {
                    elements[k - 1].style.height = `${arr[k - 1] * 15}px`;
                    elements[k - 1].querySelector(
                      ".element-value"
                    ).textContent = arr[k - 1];
                  }
                });
              }

              // Remove merge highlight
              animationQueue.push(() => {
                const elements =
                  arrayContainer.querySelectorAll(".array-element");
                elements.forEach((el) => el.classList.remove("merge-active"));
              });
            }
          }
          size *= 2;
        }

        // Final animation
        animationQueue.push(() => {
          stepInfo.textContent = "TimSort completed! Array is fully sorted.";
          const elements = arrayContainer.querySelectorAll(".array-element");
          elements.forEach((el) => {
            el.classList.add("active");
            setTimeout(() => el.classList.remove("active"), 1000);
          });
        });
      }

      // Run animation queue
      async function runAnimation() {
        if (animationQueue.length === 0) {
          timSortWithVisualization();
        }

        isRunning = true;
        runBtn.innerHTML = '<i class="fas fa-pause"></i> Pause';

        for (const action of animationQueue) {
          if (!isRunning) break;
          action();
          await new Promise((resolve) => setTimeout(resolve, speed));
        }

        isRunning = false;
        runBtn.innerHTML = '<i class="fas fa-play"></i> Run';
      }

      // Event Listeners
      runBtn.addEventListener("click", () => {
        if (isRunning) {
          isRunning = false;
          runBtn.innerHTML = '<i class="fas fa-play"></i> Run';
        } else {
          runAnimation();
        }
      });

      resetBtn.addEventListener("click", () => {
        isRunning = false;
        initVisualization();
        runBtn.innerHTML = '<i class="fas fa-play"></i> Run';
      });

      randomBtn.addEventListener("click", () => {
        // Generate random array
        const randomArray = [];
        const length = Math.floor(Math.random() * 15) + 10; // 10-24 elements
        for (let i = 0; i < length; i++) {
          randomArray.push(Math.floor(Math.random() * 20) + 1);
        }
        arrayInput.value = randomArray.join(", ");
        resetBtn.click();
      });

      speedSlider.addEventListener("input", () => {
        const speeds = {
          1: { value: "Very Slow", delay: 1000 },
          2: { value: "Slow", delay: 800 },
          3: { value: "Medium Slow", delay: 600 },
          4: { value: "Medium", delay: 400 },
          5: { value: "Medium", delay: 400 },
          6: { value: "Medium Fast", delay: 250 },
          7: { value: "Fast", delay: 150 },
          8: { value: "Faster", delay: 80 },
          9: { value: "Very Fast", delay: 40 },
          10: { value: "Lightning", delay: 20 },
        };

        const speedSetting = speeds[speedSlider.value];
        speedValue.textContent = speedSetting.value;
        speed = speedSetting.delay;
      });

      copyBtn.addEventListener("click", function () {
        const code = document.querySelector(".code-block code").innerText;
        navigator.clipboard.writeText(code);

        // Show feedback
        const originalText = this.innerHTML;
        this.innerHTML = '<i class="fas fa-check"></i> Copied!';

        setTimeout(() => {
          this.innerHTML = originalText;
        }, 2000);
      });

      // Initialize
      document.addEventListener("DOMContentLoaded", () => {
        initVisualization();
        speedSlider.dispatchEvent(new Event("input"));
      });
    </script>
  </body>
</html>
